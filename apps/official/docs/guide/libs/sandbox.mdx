# SandBox

import { SourceCode, PackageManagerTabs } from 'rspress/theme';
import { Button } from '@/components/ui/Button';
import { FileCode2Icon, SquareArrowOutUpRightIcon  } from 'lucide-react'

<div className="flex space-x-2 items-center">    
    <a className="flex space-x-1 items-center" href="https://github.com/hikestack/hike/tree/main/packages/sandbox" target="_blank">
        <Button variant="secondary" size="sm">      
             <span>源码</span>
            <FileCode2Icon className="w-4 h-4 ml-1" />
        </Button>
    </a>
   
    <a className="flex space-x-1 items-center" href="/official/reference/sandbox/globals">
        <Button variant="secondary" size="sm">
            <span>API 参考</span>
            <SquareArrowOutUpRightIcon className="w-4 h-4 ml-1" />
        </Button>
    </a>
</div>

```SandBox```是一种用于分离正在运行的程序的安全机制，通常是为了减轻系统故障或软件漏洞的传播。它通常用于执行未经测试或不受信任的程序或代码，可能来自未经验证或不受信任的第三方、供应商、用户或网站，而不会对主机或操作系统造成伤害。

## 安装
 
<PackageManagerTabs command="install @hikestack/sandbox" />

## 使用

```ts
import { Sandbox } from '@hikestack/sandbox';

interface GenerateTextProps {
    prompt: string;
    maxTokens: number;
    model: "gpt-3" | "gpt-4";
}

const code = `
    AI.generateText({
        prompt: 'hello world',
        maxTokens: 100,
        model: 'gpt-3',
    }).then(console.log);
`;

// 开放给第三方插件的能力
const scope = {
    AI: {
        generateText: async (options: GenerateTextProps) => {},
    },
};

const prototypeWhitelist = Sandbox.SAFE_PROTOTYPES;
prototypeWhitelist.set(Node, new Set());

const globals = { ...Sandbox.SAFE_GLOBALS };
const sandbox = new Sandbox({ globals, prototypeWhitelist });
const exec = sandbox.compile(code);
exec(scope).run();
```