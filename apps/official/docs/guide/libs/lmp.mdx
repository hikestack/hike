# LMP

import { PackageManagerTabs } from 'rspress/theme';
import { Button } from '@/components/ui/Button';
import { FileCode2Icon, SquareArrowOutUpRightIcon  } from 'lucide-react'

<div className="flex space-x-2 items-center">    
    <a className="flex space-x-1 items-center" href="https://github.com/hikestack/hike/tree/main/packages/ell" target="_blank">
        <Button variant="secondary" size="sm">      
             <span>源码</span>
            <FileCode2Icon className="w-4 h-4 ml-1" />
        </Button>
    </a>
   
    <a className="flex space-x-1 items-center" href="/official/reference/ell/globals">
        <Button variant="secondary" size="sm">
            <span>API 参考</span>
            <SquareArrowOutUpRightIcon className="w-4 h-4 ml-1" />
        </Button>
    </a>
</div>

`ell` 是一个轻量级的Prompt工程库，它将`Prompt`视为函数而不仅仅是字符串，将语言模型作为一个离散的子例程，称为语言模型程序（LMP）

在实践中对语言模型的每一次调用都是有价值的，`LLM`调用将被用于微调、蒸馏、k-shot提示、来自人类反馈的强化学习等。

一个好的`Prompt`工程系统应该把这些作为第一流的概念，同时`Prompt`工程库不应该改变您的现有工作流程。

## 安装
 
<PackageManagerTabs command="install @hikestack/ell" />

:::tip 提示
尚未发布
:::

## 使用

```ts
import { simple, system, user, assistant } from '@hikestack/ell';

@simple({
    model: 'gpt-4o-mini',
    temperature: 1.0
})
async function generate_story_ideas(about: string) {
    system`你是一个专业的故事构思者。每次只用一句话回答。`;
    return user`请生成一个关于${about}的故事的想法`;
}

@simple({
    model: 'gpt-4o-mini',
    temperature: 1.0
})
async function write_a_draft_of_a_story(idea: string) {
    system`你是一位擅长写故事的人。这个故事应该只有3段。`;
    return user`请写一个关于${idea}的故事`;
}

@simple({
    model: 'gpt-4o',
    temperature: 0.1
})
async function choose_the_best_draft(drafts: string[]) {
    system`你是一名专业小说编辑。`;
    return user`请从以下列表中选择最佳草稿：${drafts.join('\n')}。`;
}

@simple({
    model: 'gpt-4o-turbo',
    temperature: 0.2
})
async function write_a_really_good_story(about: string) {
    system`你是一位以海明威风格写作的专家小说家。`;
    // 注意：您可以传递参数来控制语言模型调用，在n = 4的情况下，告诉OpenAI生成一批4个输出。
    const ideas = await generate_story_ideas(about)({ n: 4 });
    const drafts = await Promise.all(ideas.map(idea => write_a_draft_of_a_story(idea)()));
    const bestDraft = await choose_the_best_draft(drafts)();
    return user`用你的风格对这个故事进行最后的修订：${bestDraft}。`;
}

const story = await write_a_really_good_story("山姆奥特曼")();

```